{% extends 'base.html' %}
{% block head %}
  <!-- Local JS file added-->
  <script type="text/javascript" src="{{url_for('static', filename='scripts/result-question-set.js')}}"></script>
{% endblock head%}

{% block main %}
  <div class="content-questionset">
    <h1 class="text-center my-4">{{question_set.name}}</h1>
    <div class="mb-2" id="{{question_set.is_public_label}}">
      <div class="text-center" id="privacy-title"></div>
      <div class="text-center" id="privacy-text"></div>
    </div>
    <div class="text-right mb-4" id="date-created">
      {{question_set.date_created}}
    </div>

    {% if questions.unanswered_questions_count > 0 %}
      <div class="d-flex m-auto my-4">
        <i class="fas fa-exclamation-triangle icon-danger icon-lg m-auto"></i>
      </div>
      <div class="alert alert-danger my-4 p-4" role="alert" id="empty-note">
        You still have unanswered questions!
      </div>
      <a class="btn btn-outline-primary btn-lg d-flex mt-4 mx-auto w-25" type="button" 
        href="{{url_for('answer_question_set.answer_question_set_get', set_id=question_set.id, uid=uid )}}">
        <span class="m-auto">Answer quiz now</span>        
      </a>
    {% else %}
      <!-- Display Manual questions -->
      <div class="my-4" id="manual-questions">
        {% for question in questions.manual_questions %}
          <div class="card w-100 my-4">
            <div class="card-header card-ans-header">
              <div class="title">
                <i class="fas fa-fist-raised"></i>
                <strong>Question:</strong> {{question.question}}
              </div>
            </div>
            <div class="card-body">
              <p>{{question.answer.answer}}</p>
              <hr>
              {% if question.answer.mark %}
                <p><i class="fas fa-marker icon-success">
                  </i>Mark: {{question.answer.mark}}</p>
              {% else %}
                <p class="text-right">
                  <i class="fas fa-marker icon-success"></i> 
                  This questions has not been marked yet.</p>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>

      <!-- Display multichoice questions -->
      <div class="my-4" id="multichoice-questions">
        {% for question in questions.multichoice_questions %}
          <div class="card w-100 my-4">
            <div class="card-header card-ans-header">
              <div class="title">
                <i class="fas fa-tasks"></i>
                <strong>Question:</strong> {{question.question}}
              </div>
            </div>
            <div class="card-body">
              <ul class="list-group list-group-flush" id="multichoice-question-list">
                {% for option in question.options %}
                  <li class="list-group-item list-group-item-action list-group-item-light">
                    {{option.option}}
                    {{option.id}}
                    {% if option.is_correct and question.answer.multichoice_option_id == option.id%}
                      <i class="fas fa-check-circle icon-correct"></i>
                    {% elif not option.is_correct and question.answer.multichoice_option_id == option.id%}
                      <i class="fas fa-times-circle icon-danger"></i>
                    {% endif %}
                  </li>
                {% endfor %}
              </ul>
            </div>
          </div>
        {% endfor %}
      </div>

      <!-- Display voting questions -->
      <div class="my-4" id="voting-questions">
        {% for question in questions.voting_questions %}
          <div class="card w-100 my-4">
            <div class="card-header card-ans-header">
              <div class="title">
                <i class="fas fa-tasks"></i>
                <strong>Question:</strong> {{question.question}}
              </div>
            </div>
            <div class="card-body">
              <p class="text-right">Total of votes = {{question.total_votes}}</p>
              <ul class="list-group list-group-flush" id="voting-question-list">
                {% for option in question.options %}
                  <li class="list-group-item list-group-item-action list-group-item-light">
                    {{option.option}} ({{option.votes}} votes)
                    <div class="progress" style="height: 26px;">
                      {% if option.id == question.answer.voting_option_id %}
                        <div class="progress-bar bg-success" 
                          role="progressbar" 
                          style="width: {{option.votes_percent}}%;" 
                          aria-valuenow="{{option.votes_percent}}" 
                          aria-valuemin="0" 
                          aria-valuemax="100">
                          {{option.option}} {{option.votes_percent}}%
                        </div>
                      {% else %}
                        <div class="progress-bar bg-primary" 
                          role="progressbar" 
                          style="width: {{option.votes_percent}}%;" 
                          aria-valuenow="{{option.votes_percent}}" 
                          aria-valuemin="0" 
                          aria-valuemax="100">
                          {{option.option}} {{option.votes_percent}}%
                        </div>
                      {% endif %}
                    </li>
                  {% endfor %}
                </div>
              </ul>
              <div class="m-4">
                <p class="text-right px-4">
                  <i class="fas fa-square icon-success"></i> Your answer
                </p>
                <p class="text-right px-4">
                  <i class="fas fa-square icon-primary"></i> Community answer
                </p>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
{% endblock %}